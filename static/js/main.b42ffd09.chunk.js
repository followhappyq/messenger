(this.webpackJsonpmessenger=this.webpackJsonpmessenger||[]).push([[0],{238:function(e,t,a){"use strict";a.r(t);var n=a(22),r={items:[]};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments.length>1?arguments[1]:void 0,a=t.type,s=t.payload;switch(a){case"ATTACHMENTS:SET_ITEMS":return Object(n.a)({},e,{items:s});case"ATTACHMENTS:REMOVE_ITEM":return Object(n.a)({},e,{items:e.items.filter((function(e){return e.uid!==s.uid}))});default:return e}}},239:function(e,t,a){"use strict";a.r(t);var n=a(22),r={items:[],currentDialogId:window.location.pathname.split("dialog/")[1],isLoading:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments.length>1?arguments[1]:void 0,a=t.type,s=t.payload;switch(a){case"DIALOGS:SET_ITEMS":return Object(n.a)({},e,{items:s});case"DIALOGS:SET_CURRENT_DIALOG_ID":return Object(n.a)({},e,{currentDialogId:s});default:return e}}},240:function(e,t,a){"use strict";a.r(t);var n=a(103),r=a(22),s={items:[],isLoading:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0,a=t.type,i=t.payload;switch(a){case"MESSAGES:ADD_MESSAGE":return Object(r.a)({},e,{items:[].concat(Object(n.a)(e.items),[i])});case"MESSAGES:SET_ITEMS":return Object(r.a)({},e,{items:i,isLoading:!1});case"MESSAGES:REMOVE_MESSAGE":return Object(r.a)({},e,{items:Object(n.a)(e.items.filter((function(e){return e._id!==i})))});case"MESSAGES:SET_IS_LOADING":return Object(r.a)({},e,{isLoading:i});default:return e}}},241:function(e,t,a){"use strict";a.r(t);var n=a(22),r={data:null,token:window.localStorage.token,isAuth:!!window.localStorage.token};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments.length>1?arguments[1]:void 0,a=t.type,s=t.payload;switch(a){case"USER:SET_DATA":return Object(n.a)({},e,{data:s,isAuth:!0,token:window.localStorage.token});case"USER:SET_IS_AUTH":return Object(n.a)({},e,{isAuth:s});default:return e}}},251:function(e,t,a){e.exports=a.p+"static/media/readed.2da46147.svg"},252:function(e,t,a){e.exports=a.p+"static/media/noreaded.1456f013.svg"},277:function(e,t,a){e.exports=a(551)},286:function(e,t,a){},332:function(e,t,a){},345:function(e,t,a){},348:function(e,t,a){},362:function(e,t,a){},451:function(e,t,a){},460:function(e,t,a){},471:function(e,t,a){},476:function(e,t,a){},510:function(e,t){},529:function(e,t,a){},544:function(e,t,a){var n={"./":99,"./attachments":238,"./attachments.js":238,"./dialogs":239,"./dialogs.js":239,"./index":99,"./index.js":99,"./messages":240,"./messages.js":240,"./user":241,"./user.js":241};function r(e){var t=s(e);return a(t)}function s(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=s,e.exports=r,r.id=544},547:function(e,t,a){},548:function(e,t,a){},549:function(e,t,a){},551:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(4),i=a.n(s),c=a(46),l=a(25),o=a(135),u=a(44),m=a(554),d=a(557),f=a(568),g=a(569),E=a(69),p=a(2),h=a.n(p),v=(a(286),function(e){return r.a.createElement(E.a,Object.assign({className:h()("button",e.className,{"button--large":"large"===e.size})},e))}),b=(a(332),function(e){var t=e.children,a=e.className;return r.a.createElement("div",{className:h()("block",a)},t)}),S=a(245),_=a.n(S),O=a(136),w=a(561),y=a(562),j=(a(345),function(e){var t=e.user,a=e.text,n=e.date,s=e.isMe,i=e.readed,c=e.attachments,l=e.isTyping,o=e.onRemoveMessage;return r.a.createElement("div",{className:h()("message",{"message--isme":s,"message--is-typing":l,"message--image":c&&1===c.length})},r.a.createElement("div",{className:"message__content"},r.a.createElement(H,{isMe:s,isReaded:i}),r.a.createElement(w.a,{content:r.a.createElement("div",null,r.a.createElement(E.a,{onClick:o},"Delete message")),trigger:"click"},r.a.createElement("div",{className:"message__icon-actions"},r.a.createElement(y.a,{style:{fontSize:20}}))),r.a.createElement("div",{className:"message__avatar"},r.a.createElement(Q,{user:t})),r.a.createElement("div",{className:"message__info"},(a||l)&&r.a.createElement("div",{className:"message__bubble"},a&&r.a.createElement("p",{className:"message__text"},_()(a,/:(.+?):/g,(function(e,t){return r.a.createElement(O.a,{emoji:e,set:"apple",size:16})}))),l&&r.a.createElement("div",{className:"message__typing"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null))),r.a.createElement("div",{className:"message__attachments"},c&&c.map((function(e,t){return r.a.createElement("div",{key:t,className:"message__attachments-item"},r.a.createElement("img",{src:e.url,alt:e.filename}))}))),n&&r.a.createElement("span",{className:"message__date"},r.a.createElement(V,{date:n})))))});j.defaultProps={user:{}};var I=j,N=a(553),A=a(91),k=(a(348),function(e){var t=e.blockRef,a=e.isLoading,n=e.items,s=e.user,i=e.onRemoveMessage;return r.a.createElement("div",{ref:t,className:h()("messages",{"messages--loading":a})},a?r.a.createElement(N.a,{size:"large",tip:"Messages are loading"}):n&&!a?n.length>0?n.map((function(e){return r.a.createElement(I,Object.assign({key:e._id},e,{isMe:s._id===e.user._id,onRemoveMessage:i.bind(void 0,e._id)}))})):r.a.createElement(A.a,{description:"Dialog is empty"}):r.a.createElement(A.a,{description:"Open dialog"}))}),M=a(176),D=a.n(M),C=a(248),x=a.n(C),R=(a(362),function(e){var t,a=e._id,n=e.isMe,s=e.currentDialogId,i=e.lastMessage,c=e.partner,l=e.userId;return r.a.createElement(u.b,{to:"/dialog/".concat(a)},r.a.createElement("div",{className:h()("dialogs__item",{"dialogs__item--online":c.isOnline,"dialogs__item--selected":s===a})},r.a.createElement("div",{className:"dialogs__item-avatar"},r.a.createElement(Q,{user:i.user})),r.a.createElement("div",{className:"dialogs__item-info"},r.a.createElement("div",{className:"dialogs__item-info-top"},r.a.createElement("b",null,c.login),r.a.createElement("span",null,(t=i.createdAt,x()(t)?D()(t,"HH:mm"):D()(t,"DD.MM.YYYY")))),r.a.createElement("div",{className:"dialogs__item-info-bottom"},r.a.createElement("p",null,i.user._id===l?"You: ".concat(i.text):"".concat(c.login,": ").concat(i.text)),n&&r.a.createElement(H,{isMe:n,isReaded:i.readed}),i.undread>0&&r.a.createElement("div",{className:"dialogs__item-info-bottom-count"},i.undread>9?"+9":i.undread)))))}),L=a(250),T=a.n(L),U=a(119),G=a.n(U),V=function(e){var t=e.date;return r.a.createElement(n.Fragment,null,T()(t,{addSuffix:!0,locale:G.a}))},P=a(251),z=a.n(P),F=a(252),B=a.n(F),H=function(e){var t=e.isMe,a=e.isReaded;return t&&(a?r.a.createElement("img",{className:"message__icon-readed",src:z.a,alt:"Readed icon"}):r.a.createElement("img",{className:"message__icon-readed message__icon-readed--no",src:B.a,alt:"No readed icon"}))||null},W=a(253),Y=a.n(W),Z=(a(451),function(e){var t=e.items,a=e.userId,n=e.onSearch,s=e.inputValue,i=e.currentDialogId;return r.a.createElement("div",{className:"dialogs"},r.a.createElement("div",{className:"dialogs__search"},r.a.createElement(d.a.Search,{placeholder:"Search",onChange:function(e){return n(e.target.value)},value:s})),Y()(t,["created_at"],["desc"]).map((function(e){return r.a.createElement(R,Object.assign({key:e._id,isMe:e.author._id===a,userId:a,currentDialogId:i},e))})))}),J=(a(460),a(19)),X=a(122),q=a.n(X),K=a(559),$=function(e){var t=e.text,a=e.type,n=void 0===a?"info":a,r=e.title,s=e.duration,i=void 0===s?2:s;K.a[n]({message:r,description:t,duration:i})},Q=function(e){var t=e.user;if(t.avatar)return r.a.createElement("img",{src:t.avatar,alt:"avatar"});var a=function(e){var t=e.substr(0,3).split("").map((function(e){return(t=e.charCodeAt(0))>255?255:t<0?0:t>255?255:t<0?0:t;var t})),a=Object(J.a)(t,3),n=a[0],r=a[1],s=a[2];return{color:q()({r:n,g:r,b:s}).lighten(10).saturate(10).toHexString(),colorLighten:q()({r:n,g:r,b:s}).lighten(30).saturate(30).toHexString()}}(t._id),n=a.color,s=a.colorLighten,i=t.login[0];return r.a.createElement("div",{style:{background:"linear-gradient(135deg, ".concat(n," 0%, ").concat(s," 96%)")},className:"avatar avatar-symbol"},i)},ee=(a(471),function(e){var t=e.online,a=e.login;return r.a.createElement("div",{className:"chat__dialog-header-center"},r.a.createElement("b",{className:"chat__dialog-header-username"},a),r.a.createElement("div",{className:"chat__dialog-header-status"},r.a.createElement("div",{className:h()("status",{"status--online":t})},t?"online":"offline")))}),te=a(563),ae=a(564),ne=a(565),re=a(258),se=(a(476),function(e){var t=e.emojiPickerVisible,a=e.value,s=e.setValue,i=e.addEmoji,c=e.handleSendMessage,l=e.toggleEmojiPicker,o=e.sendMessage,u=e.attachments,m=e.onSelectFiles;return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"chat-input"},r.a.createElement("div",{className:"chat-input__smile-btn"},t&&r.a.createElement("div",{className:"chat-input__emoji-picker"},r.a.createElement(O.b,{set:"apple",onSelect:function(e){i(e)}})),r.a.createElement(te.a,{onClick:l})),r.a.createElement(d.a,{size:"large",placeholder:"Write a message...",onChange:function(e){return s(e.target.value)},onKeyUp:c,value:a}),r.a.createElement("div",{className:"chat-input__actions"},r.a.createElement(re.UploadField,{onFiles:m,containerProps:{className:"chat-input__actions-upload-btn"},uploadProps:{accept:".jpg,.png,.jpeg,.gif,.bmp",multiple:"multiple"}},r.a.createElement(ae.a,null)),r.a.createElement(ne.a,{onClick:o}))),r.a.createElement(Ke,{attachments:u}))}),ie=function(e,t,a){return t[e]?a[e]?"error":"success":" "},ce=function(e){var t=e.name,a=e.placeholder,n=e.touched,s=e.errors,i=e.handleChange,c=e.handleBlur,l=e.values,o=e.prefix,u=e.type;return r.a.createElement(m.a.Item,{validateStatus:ie(t,n,s),hasFeedback:!0,onChange:i,onBlur:c,help:n[t]?s[t]:" "},r.a.createElement(d.a,{id:t,placeholder:a,prefix:o,size:"large",value:l[t],type:u}))},le=a(566),oe=a(567),ue=a(558),me=a(556),de=a(261),fe=a.n(de)()("https://react-messenger-applicaton.herokuapp.com/"),ge=a(104),Ee=a.n(ge);Ee.a.defaults.baseURL="https://react-messenger-applicaton.herokuapp.com/",Ee.a.defaults.headers.common.token=window.localStorage.token,window.axios=Ee.a;var pe=Ee.a,he=function(){return pe.get("/dialogs")},ve=function(e){var t=e.partner,a=e.text;return pe.post("/dialogs",{partner:t,text:a})},be=function(e){return pe.get("/messages?dialog="+e)},Se=function(e){return pe.delete("/messages?id="+e)},_e=function(e,t,a){return pe.post("/messages",{text:e,dialog_id:t,attachments:a})},Oe=function(e){return pe.post("/user/signin",e)},we=function(e){return pe.post("/user/signup",e)},ye=function(e){return pe.get("/user/verify?hash="+e)},je=function(){return pe.get("/user/me")},Ie=function(e){return pe.get("/user/find?query="+e)},Ne=function(e){var t=new FormData;return t.append("file",e),pe.post("/files",t,{headers:{"Content-Type":"multipart/form-data"}})},Ae={setDialogs:function(e){return{type:"DIALOGS:SET_ITEMS",payload:e}},setCurrentDialogId:function(e){return function(t){fe.emit("DIALOGS:JOIN",e),t({type:"DIALOGS:SET_CURRENT_DIALOG_ID",payload:e})}},fetchDialogs:function(){return function(e){he().then((function(t){var a=t.data;e(Ae.setDialogs(a))}))}}},ke=Ae,Me={setMessages:function(e){return{type:"MESSAGES:SET_ITEMS",payload:e}},addMessage:function(e){return function(t,a){a().dialogs.currentDialogId===e.dialog._id&&t({type:"MESSAGES:ADD_MESSAGE",payload:e})}},setIsLoading:function(e){return{type:"MESSAGES:SET_IS_LOADING",payload:e}},removeMessageById:function(e){return function(t){console.log(e),Se(e).then((function(a){a.data;t({type:"MESSAGES:REMOVE_MESSAGE",payload:e})})).catch((function(){t(Me.setIsLoading(!1))}))}},fetchSendMessage:function(e,t,a){return function(n){_e(e,t,a)}},fetchMessages:function(e){return function(t){t(Me.setIsLoading(!0)),be(e).then((function(e){var a=e.data;t(Me.setMessages(a))})).catch((function(){t(Me.setIsLoading(!1))}))}}},De=Me,Ce={setUserData:function(e){return{type:"USER:SET_DATA",payload:e}},setIsAuth:function(e){return{type:"USER:SET_IS_AUTH",payload:e}},fetchUserData:function(){return function(e){je().then((function(t){var a=t.data;e(Ce.setUserData(a))})).catch((function(t){403===t.response.status&&(e(Ce.setIsAuth(!1)),delete window.localStorage.token)}))}},fetchUserLogin:function(e){return function(t){return Oe(e).then((function(e){var a=e.data,n=a.token;return $({title:"Success",text:"Authorization has been successful.",type:"success"}),window.axios.defaults.headers.common.token=n,window.localStorage.token=n,t(Ce.fetchUserData()),t(Ce.setIsAuth(!0)),a})).catch((function(e){403===e.response.status&&$({title:"Authentication failed.",text:"Incorrect login or password.",type:"error"})}))}},fetchUserRegister:function(e){return function(t){return we(e).then((function(e){return e.data}))}}},xe=Ce,Re=Object(l.b)((function(e){return e.dialogs}),ke)((function(e){var t=e.fetchDialogs,a=e.currentDialogId,s=e.items,i=e.userId,c=Object(n.useState)(""),l=Object(J.a)(c,2),o=l[0],u=l[1],m=Object(n.useState)(Array.from(s)),d=Object(J.a)(m,2),f=d[0],g=d[1],E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";g(s.filter((function(t){return t.author.login.toLowerCase().indexOf(e.toLowerCase())>=0||t.partner.login.toLowerCase().indexOf(e.toLowerCase())>=0}))),u(e)};return Object(n.useEffect)((function(){s.length&&E()}),[s]),Object(n.useEffect)((function(){return t(),fe.on("SERVER:DIALOG_CREATED",t),fe.on("SERVER:NEW_MESSAGE",t),function(){fe.removeListener("SERVER:DIALOG_CREATED",t),fe.removeListener("SERVER:NEW_MESSAGE",t)}}),[]),r.a.createElement(Z,{userId:i,items:f,onSearch:E,inputValue:o,currentDialogId:a})})),Le=Object(l.b)((function(e){var t=e.dialogs,a=e.messages,n=e.user;return{currentDialogId:t.currentDialogId,items:a.items,isLoading:a.isLoading,user:n.data}}),De)((function(e){var t=e.currentDialogId,a=e.fetchMessages,s=e.addMessage,i=e.items,c=e.user,l=e.isLoading,o=e.removeMessageById,u=Object(n.useRef)(null),m=function(e){s(e)};return Object(n.useEffect)((function(){return t&&a(t),fe.on("SERVER:NEW_MESSAGE",m),function(){return fe.removeListener("SERVER:NEW_MESSAGE",m)}}),[t]),Object(n.useEffect)((function(){u.current&&u.current.scrollTo(0,u.current.scrollHeight)}),[i]),t?r.a.createElement(k,{user:c,blockRef:u,items:i,isLoading:l&&!c,onRemoveMessage:o}):r.a.createElement(A.a,{description:"Open dialog"})})),Te=a(71),Ue=a.n(Te),Ge=a(103),Ve=a(133),Pe=Object(l.b)((function(e){return e.dialogs}),De)((function(e){var t=e.fetchSendMessage,a=e.currentDialogId,s=Object(n.useState)(""),i=Object(J.a)(s,2),c=i[0],l=i[1],o=Object(n.useState)([]),u=Object(J.a)(o,2),m=u[0],d=u[1],f=Object(n.useState)(""),g=Object(J.a)(f,2),E=g[0],p=g[1],h=function(){t(c,a,m.map((function(e){return e.uid}))),d([]),l("")},v=function(){var e=Object(Ve.a)(Ue.a.mark((function e(t){var a,n,r;return Ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n=Ue.a.mark((function e(n){var r,s;return Ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[n],s=Math.round(1e3*Math.random()),a=[].concat(Object(Ge.a)(a),[{uid:s,name:r.name,status:"uploading"}]),d(a),e.next=6,Ne(r).then((function(e){var t=e.data;a=a.map((function(e){return e.uid===s?{status:"done",uid:t.file._id,name:t.file.filename,url:t.file.url}:e}))}));case 6:case"end":return e.stop()}}),e)})),r=0;case 3:if(!(r<t.length)){e.next=8;break}return e.delegateYield(n(r),"t0",5);case 5:r++,e.next=3;break;case 8:d(a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a?r.a.createElement(se,{value:c,setValue:l,emojiPickerVisible:E,toggleEmojiPicker:function(){p(!E)},handleSendMessage:function(e){13===e.keyCode&&c.trim()&&h()},addEmoji:function(e){var t=e.colons;l((c+" "+t).trim())},sendMessage:h,attachments:m,onSelectFiles:v}):null})),ze=Object(l.b)((function(e){var t=e.dialogs,a=e.user;return{dialogs:t.items,currentDialogId:t.currentDialogId,user:a.data}}))((function(e){var t=e.currentDialogId,a=e.user,n=e.dialogs;if(!n.length||!t)return null;var s=n.filter((function(e){return e._id===t}))[0],i={};return i=s.author._id===a._id?s.partner:s.author,r.a.createElement(ee,{online:i.isOnline,login:i.login})})),Fe=Object(l.b)((function(e){return{user:e.user.data}}))((function(e){var t=e.user,a=Object(n.useState)(!1),s=Object(J.a)(a,2),i=s[0],c=s[1],l=Object(n.useState)(""),o=Object(J.a)(l,2),u=o[0],m=o[1],d=Object(n.useState)(""),f=Object(J.a)(d,2),g=f[0],E=f[1],p=Object(n.useState)([]),h=Object(J.a)(p,2),v=h[0],b=h[1],S=Object(n.useState)(!1),_=Object(J.a)(S,2),O=_[0],w=_[1],y=Object(n.useState)(!1),j=Object(J.a)(y,2),I=j[0],N=j[1],A=function(){c(!1)};return r.a.createElement(Ye,{user:t,inputValue:u,visible:i,isLoading:O,onClose:A,onShow:function(){c(!0)},onSearch:function(e){w(!0),Ie(e).then((function(e){var t=e.data;b(t),w(!1)})).catch((function(){w(!1)}))},onChangeInput:function(e){m(e)},onSelectUser:function(e){N(e)},onModalOk:function(){ve({partner:I,text:g}).then(A).catch((function(){w(!1)}))},onChangeTextArea:function(e){E(e.target.value)},messageText:g,selectedUserId:I,users:v})})),Be=(a(529),ue.a.Option),He=d.a.TextArea,We=function(e){var t=e.user,a=e.visible,n=e.inputValue,s=e.messageText,i=e.selectedUserId,c=e.isLoading,l=e.users,o=e.onShow,u=e.onClose,d=e.onSearch,f=e.onChangeInput,g=e.onSelectUser,p=e.onChangeTextArea,h=e.onModalOk,v=l.map((function(e){return r.a.createElement(Be,{key:e._id},e.login)}));return r.a.createElement("div",{className:"chat__sidebar"},r.a.createElement("div",{className:"chat__sidebar-header"},r.a.createElement("div",null,r.a.createElement(le.a,{style:{fontSize:17}})),r.a.createElement(oe.a,{onClick:o,style:{fontSize:17}})),r.a.createElement("div",{className:"chat__sidebar-dialogs"},r.a.createElement(Re,{userId:t&&t._id})),r.a.createElement(me.a,{title:"Create dialog",visible:a,footer:[r.a.createElement(E.a,{key:"back",onClick:u},"Close"),r.a.createElement(E.a,{disabled:!s,key:"submit",type:"primary",loading:c,onClick:h},"Create")]},r.a.createElement(m.a,{className:"add-dialog-form"},r.a.createElement(m.a.Item,{label:"Username or email"},r.a.createElement(ue.a,{value:n,onSearch:d,onChange:f,onSelect:g,notFoundContent:null,style:{width:"100%"},defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,placeholder:"Username or email",showSearch:!0},v)),i&&r.a.createElement(m.a.Item,{label:"Write a message"},r.a.createElement(He,{autosize:{minRows:3,maxRows:10},onChange:p,value:s})))))};We.defaultProps={users:[]};var Ye=We,Ze=a(22),Je=a(555);function Xe(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))}var qe=function(e){var t=e.attachments,a=e.removeAttachment,s=Object(n.useState)({previewVisible:!1,previewImage:"",fileList:t}),i=Object(J.a)(s,2),c=i[0],l=i[1];Object(n.useEffect)((function(){l(Object(Ze.a)({},c,{fileList:t}))}),[t]);var o=function(){var e=Object(Ve.a)(Ue.a.mark((function e(t){return Ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,Xe(t.originFileObj);case 3:t.preview=e.sent;case 4:l(Object(Ze.a)({},c,{previewImage:t.url||t.preview,previewVisible:!0}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"clearfix"},r.a.createElement(Je.a,{action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",listType:"picture-card",fileList:c.fileList,onPreview:o,onChange:function(e){var t=e.fileList;return l(Object(Ze.a)({},c,{fileList:t}))},onRemove:function(e){return a(e)}}),r.a.createElement(me.a,{visible:c.previewVisible,footer:null,onCancel:function(){return l(Object(Ze.a)({},c,{previewVisible:!1}))}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:c.previewImage})))};qe.defaultProps={attachments:[]};var Ke=qe,$e=function(e){var t=e.values,a=e.touched,n=e.errors,s=e.handleChange,i=e.handleBlur,c=e.handleSubmit,l=e.isSubmitting;return r.a.createElement("div",null,r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"Sign In to Messenger")),r.a.createElement(b,null,r.a.createElement(m.a,{onSubmit:c,className:"login-form"},r.a.createElement(m.a.Item,{validateStatus:ie("email",a,n),help:a.email?n.email:" ",hasFeedback:!0},r.a.createElement(d.a,{id:"email",placeholder:"E-mail",prefix:r.a.createElement(f.a,null),size:"large",value:t.email,onChange:s,onBlur:i})),r.a.createElement(m.a.Item,{validateStatus:ie("password",a,n),hasFeedback:!0,onChange:s,onBlur:i,help:a.password?n.password:" "},r.a.createElement(d.a.Password,{id:"password",type:"password",placeholder:"Password",prefix:r.a.createElement(g.a,null),size:"large",value:t.password})),r.a.createElement(m.a.Item,null,r.a.createElement(v,{type:"primary",htmlType:"submit",size:"large",onClick:c,disabled:l},"Sign In")),r.a.createElement(u.b,{className:"auth__register-link",to:"/signup"},"Create an account"))))},Qe=function(e){var t=e.isAuth,a=e.values,n=e.errors,r={email:function(e){e?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)||(n.email="E-mail is invalid or already taken"):n.email="E-mail can't be blank"},login:function(e){t||e||(n.login="Login can't be blank")},password:function(e,t){e?t||/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})/i.test(e)||(n.password=t?"Incorrect password":"Passwords must contain: a minimum of 1 lower case letter [a-z],1 upper case letter [A-Z] ,1 numeric character [0-9]."):n.password="Passwords must contain: a minimum of 1 lower case letter [a-z],1 upper case letter [A-Z] ,1 numeric character [0-9]."},password_2:function(e,t){(t||e===a.password)&&e||(n.password_2="Password does not match")}};Object.keys(a).forEach((function(e){return r[e]&&r[e](a[e])}))},et=a(67),tt=a(271),at=a(99),nt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||et.d,rt=[tt.a],st=Object(et.e)(at.default,nt(et.a.apply(void 0,rt))),it=Object(o.a)({enableReinitialize:!0,mapPropsToValues:function(){return{email:"",password:""}},validate:function(e){var t={};return Qe({isAuth:!0,values:e,errors:t}),t},handleSubmit:function(e,t){var a=t.setSubmitting,n=t.props;st.dispatch(xe.fetchUserLogin(e)).then((function(e){"success"===e.status&&n.history.push("/"),a(!1)})).catch((function(){a(!1)}))},displayName:"LoginForm"})($e),ct=a(570),lt=(a(571),function(e){var t=e.values,a=e.touched,n=e.errors,s=e.handleChange,i=e.handleBlur,c=e.handleSubmit,l=e.dirty,o=e.isValid,d=e.isSubmitting;return r.a.createElement("div",null,r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"Registration")),r.a.createElement(b,null,r.a.createElement(m.a,{onSubmit:c,initialValues:{remember:!0}},r.a.createElement(ce,{name:"email",prefix:r.a.createElement(f.a,null),handleChange:s,handleBlur:i,touched:a,errors:n,values:t,placeholder:"E-mail"}),r.a.createElement(ce,{name:"login",prefix:r.a.createElement(ct.a,null),handleChange:s,handleBlur:i,touched:a,errors:n,values:t,placeholder:"Login"}),r.a.createElement(ce,{name:"password",prefix:r.a.createElement(g.a,null),type:"password",handleChange:s,handleBlur:i,touched:a,errors:n,values:t,placeholder:"Password"}),r.a.createElement(ce,{name:"password_2",prefix:r.a.createElement(g.a,null),handleChange:s,type:"password",handleBlur:i,touched:a,errors:n,values:t,placeholder:"Confirm Password"}),r.a.createElement(m.a.Item,null,l&&!o&&r.a.createElement("span",null,"Error"),r.a.createElement(v,{onClick:c,disabled:d,type:"primary",htmlType:"submit",size:"large"},"Register")),r.a.createElement(u.b,{className:"auth__register-link",to:"/signin"},"Sign In"))))}),ot=Object(o.a)({enableReinitialize:!0,mapPropsToValues:function(){return{email:"",login:"",password:"",password_2:""}},validate:function(e){var t={};return Qe({isAuth:!1,values:e,errors:t}),t},handleSubmit:function(e,t){var a=t.setSubmitting,n=t.props;st.dispatch(xe.fetchUserRegister(e)).then((function(e){"success"===e.status&&n.history.push("/"),a(!1)})).catch((function(){a(!1)}))},displayName:"RegisterForm"})(lt),ut=a(560),mt=function(e){var t=e.location,a=e.history,s=Object(n.useState)(!1),i=Object(J.a)(s,2),c=i[0],l=i[1],o=t.search.split("hash=")[1],u=function(e,t){return e?t?{status:"success",message:"E-mail has been confirmed."}:{status:"error",message:"Something went wrong."}:{status:"success",message:"Registration has been successfully completed. Check your e-mail address to verify."}}(o,c);return Object(n.useEffect)((function(){o&&ye(o).then((function(e){"success"===e.data.status&&l(!0)}))})),r.a.createElement(b,null,r.a.createElement(ut.a,{status:u.status,title:"success"===u.status?"Ready!":"Error!",subTitle:u.message,extra:"success"===u.status&&c&&r.a.createElement(E.a,{type:"primary",onClick:function(){return a.push("/signin")}},"Sign In")}))},dt=(a(547),function(){return r.a.createElement("section",{className:"auth"},r.a.createElement("div",{className:"autn__content"},r.a.createElement(c.b,{exact:!0,path:"/signin",component:it}),r.a.createElement(c.b,{exact:!0,path:"/signup",component:ot}),r.a.createElement(c.b,{exact:!0,path:"/signup/verify",component:mt})))}),ft=(a(548),Object(c.g)(Object(l.b)((function(e){return{user:e.user.data}}),ke)((function(e){var t=e.setCurrentDialogId;return Object(n.useEffect)((function(){var a=e.location.pathname.split("/").pop();t(a)}),[e.location.pathname]),r.a.createElement("section",{className:"home"},r.a.createElement("div",{className:"chat"},r.a.createElement(Fe,null),r.a.createElement("div",{className:"chat__dialog"},r.a.createElement("div",{className:"chat__dialog-header"},r.a.createElement("div",null),r.a.createElement(ze,{online:!0}),r.a.createElement(y.a,{style:{fontSize:20}})),r.a.createElement("div",{className:"chat__dialog-messages"},r.a.createElement(Le,null)),r.a.createElement("div",{className:"chat__dialog-input"},r.a.createElement(Pe,null)))))})))),gt=Object(l.b)((function(e){return{isAuth:e.user.isAuth}}))((function(e){var t=e.isAuth;return r.a.createElement("div",{className:"wrapper"},r.a.createElement(c.d,null,r.a.createElement(c.b,{exact:!0,path:["/signin","/signup","/signup/verify"],component:dt}),r.a.createElement(c.b,{path:"/",render:function(){return t?r.a.createElement(ft,null):r.a.createElement(c.a,{to:"/signin"})}})))}));a(549),a(550);st.dispatch(xe.fetchUserData()),i.a.render(r.a.createElement(l.a,{store:st},r.a.createElement(u.a,null,r.a.createElement(gt,null))),document.getElementById("root"))},99:function(e,t,a){"use strict";a.r(t);var n=a(67);t.default=Object(n.c)(["messages","dialogs","user"].reduce((function(e,t){return e[t]=a(544)("./".concat(t)).default,e}),{}))}},[[277,1,2]]]);
//# sourceMappingURL=main.b42ffd09.chunk.js.map